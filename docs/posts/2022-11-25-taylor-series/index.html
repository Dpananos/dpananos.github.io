<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Demetri Pananos">
<meta name="dcterms.date" content="2022-11-25">

<title>Demetri Pananos Ph.D - Way Too Many Taylor Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Demetri Pananos Ph.D - Way Too Many Taylor Series">
<meta property="og:description" content="">
<meta property="og:site-name" content="Demetri Pananos Ph.D">
<meta name="twitter:title" content="Demetri Pananos Ph.D - Way Too Many Taylor Series">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@PhDemetri">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Demetri Pananos Ph.D</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../consulting/index.html" rel="" target="">
 <span class="menu-text">Consulting</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Dpananos" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/PhDemetri" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Way Too Many Taylor Series</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">AB Testing</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Demetri Pananos </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 25, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#taylor-series-for-random-variables" id="toc-taylor-series-for-random-variables" class="nav-link" data-scroll-target="#taylor-series-for-random-variables">Taylor Series for Random Variables</a></li>
  <li><a href="#applying-taylor-series-to-our-problem" id="toc-applying-taylor-series-to-our-problem" class="nav-link" data-scroll-target="#applying-taylor-series-to-our-problem">Applying Taylor Series To Our Problem</a></li>
  <li><a href="#we-did-itnow-what" id="toc-we-did-itnow-what" class="nav-link" data-scroll-target="#we-did-itnow-what">We Did It…Now What?</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/Dpananos/dpananos.github.io/edit/main/posts/2022-11-25-taylor-series/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/Dpananos/dpananos.github.io/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Let <span class="math inline">\(Y(a)\)</span> be a potential outcome for a continuous measure under treatment status <span class="math inline">\(A=a\)</span>, which for the purpose of this blog post can be considered a binary treatment. When is</p>
<p><span class="math display">\[  \delta = \dfrac{E[Y(1)]}{E[Y(0)]} \]</span> well approximated by <span class="math inline">\(\exp(\delta^\star)\)</span> where</p>
<p><span class="math display">\[ \delta^\star = E \left[ \ln \left( \dfrac{Y(1)}{Y(0)} \right) \right] = E[\ln(Y(1)]  - E[\ln(Y(0)] \&gt;.\]</span></p>
<p>It seems to be a <a href="https://stats.stackexchange.com/questions/163518/interpreting-test-results-on-log-transformed-data">fairly well accepted proposition</a> that the difference in means on the log scale can be interpreted as a relative change in means on the natural scale, but upon closer inspection they aren’t equivalent. Firstly, Jensen’s inequality prevents interchanging the expectation operator and the logarithm and second <span class="math inline">\(E[X/Y] \neq E[X]/E[Y]\)</span> since expectation is a linear operation. I think a more nuanced discussion is needed as to if and when we can interpret <span class="math inline">\(\exp(\delta^\star)\)</span> as <span class="math inline">\(\delta\)</span>.</p>
<p>To be clear, I’m sure this holds fairly readily. I don’t want to overstate the importance of this blog post, but I don’t want to understate it either. This question came up when considering how AB tests should measure changes in continuous metrics, like revenue. Log-transforming revenue to reign in tails is common advice – and I think that’s fine, especially when it makes the sampling distribution of the sample mean more normal looking. Additionally, talking about changes in a relative sense (i.e.&nbsp;“lift” in the metric) is something that comes natural to a lot of companies. But if we’re going to use <span class="math inline">\(\delta^\star\)</span> as the metric for our experiment, then I personally would like to understand under what conditions this is a good approximation. What assumptions am I implicitly making? I don’t think curiosity in that sense is a bad thing, or a waste of time.</p>
</section>
<section id="taylor-series-for-random-variables" class="level2">
<h2 class="anchored" data-anchor-id="taylor-series-for-random-variables">Taylor Series for Random Variables</h2>
<p>Before getting into the meat of the blog post, it might be worthwhile to revisit Taylor series for random variables (which we will make heavy use of in this post). Recall that a Taylor series for a continuously differentiable function <span class="math inline">\(f\)</span> is</p>
<p><span class="math display">\[ f(x) = \sum_{k=0}^{\infty} \dfrac{f^{(k)}(x_0)}{k!} (x - x_0)^k \&gt;,  \quad \mid x - x_0 \mid \lt d\]</span></p>
<p>and that the error made in approximating <span class="math inline">\(f\)</span> with first <span class="math inline">\(n+1\)</span> terms of this sum, <span class="math inline">\(R_n(x)\)</span>, can be bounded by</p>
<p><span class="math display">\[ \mid R_n(x) \mid \leq \dfrac{M}{(n+1)!}(x - x_0)^{n+1} \&gt;, \quad \mid x - x_0 \mid \lt d \&gt;.\]</span> We can also expand a function of a random variable, <span class="math inline">\(X\)</span>, in a Taylor series by considering the variation of <span class="math inline">\(X-\mu\)</span> about <span class="math inline">\(\mu\)</span></p>
<span class="math display">\[\begin{align}
f(X) &amp;= f((X-\mu) + \mu) \&gt;, \\
     &amp;= f(\mu) + f^{\prime}(\mu)(X-\mu) + \dfrac{f^{\prime\prime}(\mu)}{2}(X-\mu)^2 + \mathcal{O}\left( (X-\mu)^3 \right) \&gt;.
\end{align}\]</span>
<p>From here, we can take expectations and leverage the linearity of <span class="math inline">\(E\)</span> to get a nice second order approximation of <span class="math inline">\(E(f(X))\)</span></p>
<span class="math display">\[\begin{align}
E[f(X)] &amp;\approx  E[f(\mu)] + f^{\prime}(\mu)E[(X-\mu)] + \dfrac{f^{\prime\prime}(\mu)}{2}E[(X-\mu)^2] \&gt;, \\
        &amp;\approx  f(\mu) + \dfrac{f^{\prime\prime}(\mu)}{2}\sigma^2 \&gt;.
\end{align}\]</span>
</section>
<section id="applying-taylor-series-to-our-problem" class="level2">
<h2 class="anchored" data-anchor-id="applying-taylor-series-to-our-problem">Applying Taylor Series To Our Problem</h2>
<p>The quantity <span class="math inline">\(\exp(\delta^\star)\)</span> could be approximately be <span class="math inline">\(\delta\)</span> under the right circumstances. Let’s expand <span class="math inline">\(\ln(Y(1)/Y(0))\)</span> in a Taylor series centered around <span class="math inline">\(Y(1)/Y(0) = 1\)</span>. We’re going to be doing quite a few Taylor expansions, so I’m going to color code some of them in order to keep track of which terms belong to which expansion.</p>
<span class="math display">\[\begin{align}
E\left[\ln \left( \dfrac{Y(1)}{Y(0)} \right)\right] &amp;\approx E \left [ \textcolor{#1f77b4}{\left( \dfrac{Y(1)}{Y(0)} -1 \right) + \dfrac{1}{2} \left(  \dfrac{Y(1)}{Y(0)} -1 \right)^2} \right] \&gt;,\\
&amp;\approx \textcolor{#ff7f0e}{E \left[ \dfrac{Y(1)}{Y(0)} \right]}  \textcolor{#1f77b4}{- 1 + \dfrac{1}{2} E \left[\left(  \dfrac{Y(1)}{Y(0)} -1 \right)^2  \right]} \&gt;.
\end{align}\]</span>
<p>This approximation is only valid when <span class="math inline">\(0 \lt Y(1)/Y(0) \leq 2\)</span>, and the error in this approximation is bounded by <span class="math inline">\(E\left[\left(\frac{Y(1)}{Y(0)} -1\right)^3\right]\)</span>. Note that we almost have <span class="math inline">\(\delta\)</span> in our Taylor series expansion, but not quite. We can apply yet another Taylor series expansion on the part in orange to yield</p>
<span class="math display">\[\begin{align}
\textcolor{#ff7f0e}{E\left[ \dfrac{Y(1)}{Y(0)} \right] \approx \dfrac{E[Y(1)]}{E[Y(0)]} -\frac{\operatorname{cov}[Y(1), Y(0)]}{\mathrm{E}[Y(0)]^2}+\frac{\mathrm{E}[Y(1)]}{\mathrm{E}[Y(0)]^3} \operatorname{var}[Y(0)]} \&gt;.
\end{align}\]</span>
<p>Let’s assemble this all together now. Our approximation is now</p>
<span class="math display">\[\begin{align}
E\left[\ln \left( \dfrac{Y(1)}{Y(0)} \right)\right]  &amp;\approx \textcolor{#ff7f0e}{ \dfrac{E[Y(1)]}{E[Y(0)]} -\frac{\operatorname{cov}[Y(1), Y(0)]}{\mathrm{E}[Y(0)]^2}+\frac{\mathrm{E}[Y(1)]}{\mathrm{E}[Y(0)]^3} \operatorname{var}[Y(0)]}  \textcolor{#1f77b4}{- 1 + \dfrac{1}{2} E \left[\left(  \dfrac{Y(1)}{Y(0)} -1 \right)^2  \right]} \&gt;, \\
&amp;\approx \dfrac{E[Y(1)]}{E[Y(0)]} - 1 \textcolor{#ff7f0e}{-\frac{\operatorname{cov}[Y(1), Y(0)]}{\mathrm{E}[Y(0)]^2}+\frac{\mathrm{E}[Y(1)]}{\mathrm{E}[Y(0)]^3} \operatorname{var}[Y(0)]} \textcolor{#1f77b4}{ + \dfrac{1}{2} E \left[\left(  \dfrac{Y(1)}{Y(0)} -1 \right)^2  \right]} \&gt;.
\end{align}\]</span>
<p>Finally <span class="math inline">\(\delta\)</span> appears in our long and tedious approximation of <span class="math inline">\(\delta^\star\)</span>. Let’s ignore the terms colored in blue and orange for a moment and come back to them later.</p>
<p>Our approximation is now</p>
<p><span class="math display">\[E\left[\ln \left( \dfrac{Y(1)}{Y(0)} \right)\right] \approx \dfrac{E[Y(1)]}{E[Y(0)]} - 1\]</span></p>
<p><span class="math display">\[ \delta^\star \approx \delta -1  \]</span></p>
<p>Exponentiating both sides</p>
<span class="math display">\[\begin{align}
\exp(\delta^\star) &amp;\approx \exp(\delta-1) \\
&amp; \approx 1 + \delta -1 +  \mathcal{O}((\delta-1)^2)\\
&amp; \approx \delta
\end{align}\]</span>
</section>
<section id="we-did-itnow-what" class="level2">
<h2 class="anchored" data-anchor-id="we-did-itnow-what">We Did It…Now What?</h2>
<p>Now that we’ve written down all the necessary approximations and assumptions, let’s go back and determine under what circumstances this is a valid approximation. Can we break this approximation? Can we break it really badly?</p>
<p>Let’s leave that for the next blog post. I’m tired from doing all this algebra.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>